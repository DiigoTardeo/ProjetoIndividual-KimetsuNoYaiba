<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style-paginas-gerais.css">
    <link rel="stylesheet" href="./dashboards.css">
    <script src="../js/funcoes.js"></script>
    <title>KNY| Perfil</title>
</head>
<body>
    <div class="alerta_erro">
        <div class="card_erro" id="cardErro">
            <span id="mensagem_erro"></span>
        </div>
    </div>

    <!-- HEADER LEFT -->
    <div class="aba">
        <div class="header-left" id="aba_left">
            <button class="btn_abrirAba" id="btn_abreAba" onclick="abrirAba()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-list-nested" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M4.5 11.5A.5.5 0 0 1 5 11h10a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 1 3h10a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.5-.5z"/>
                  </svg>
            </button>
            <div class="botoes_acesso">
                <button class="btn_exit" id="btn_sair" onclick= "window.location.href = '../index.html'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
                        <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1z"/>
                        <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117zM11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5zM4 1.934V15h6V1.077l-6 .857z"/>
                    </svg>
                </button>
                <button class="btn_fecharAba" id="btn_fechaAba" onclick="fecharAba()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-reply-fill" viewBox="0 0 16 16">
                        <path d="M5.921 11.9 1.353 8.62a.719.719 0 0 1 0-1.238L5.921 4.1A.716.716 0 0 1 7 4.719V6c1.5 0 6 0 7 8-2.5-4.5-7-4-7-4v1.281c0 .56-.606.898-1.079.62z"/>
                    </svg>
                </button>
            </div>
            <div class="navegacao_header" id="navegar_header">
                <div class="img_aba">
                    <img class="img_logo" src="../assets/img/login/IconeBranco.png">
                </div>
                <h1 class="titulo_aba">Olá <span id="usuario">usuário</span>!</h1>
                <div class="botoes">
                    <button class="b1" onclick="meus_dados()"> 
                        <p> Meus Dados</p>
                    </button>
                    <button class="b2" onclick="missoes()"> 
                        <p>Missões</p>
                    </button>
                    <a href="#cadastro_Funcionario">
                        <button class="b43" onclick="voto()">
                            <p>Voto Rank</p>
                        </button>
                    </a>
                    <button class="b4" onclick="window.location.href = './mural.html'">
                        <a href="./mural.html"><p>Sugestões</p></a>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- TELA DADOS -->
    <div class="container-dados" id="container_dados">
        <h2>DADOS</h2>
        <span class="status">Status: Aprovado.</span>
        <span class="mestre">Mestre: </span>
        <span class="espada">Espada: </span>
    </div>

    <!-- TELA MISSÕES -->
    <div class="container-missoes" id="container_missoes">
        <h2>MISSÕES</h2>
        <span class="regiao">Região: </span>
        <span class="nivelOni">Nível Oni: </span>
        <span class="pessoasAtacadas">Pessoas Atacadas: </span>
    </div>

    <!-- VOTOS -->
    <div class="container-voto" id="container_voto">
        <h2> VOTO RANKING: </h2>
        <span class="txt-voto">
            Aqui você vai escolher o personagem que você mais gosta no Kimestsu no Yaiba e esses personagens pode estar tanto entre os exterminadores e onis
        </span>
        <select name="slc_personagem" id="slc_personagem" class="slc_personagem" onclick="personagem()">
            <option value="select" disabled selected>-- SELECIONE UM PERSONAGEM --</option>
            <option value="1"> Kagaya Ubuyashiki </option>
            <option value="2"> Gyomei Himejima </option>
	        <option value="3"> Sanemi Shinazugawa </option>
	        <option value="4"> Muichiro Tokito </option>
	        <option value="5"> Giyu Tomioka </option>
	        <option value="6"> Obanai Iguro </option>
	        <option value="7"> Mitsuri Kanroji </option>
	        <option value="8"> Tengen Uzui </option>
	        <option value="9"> Kyojuro Rengoku </option>
	        <option value="10"> Shinobu Kocho </option>
	        <option value="11"> Tanjiro Kamado </option>
	        <option value="12"> Nezuko Kamado </option>
	        <option value="13"> Inosuke Hashibira </option>
	        <option value="14"> Zenitsu Agatsuma </option>
	        <option value="15"> Muzan Kibutsuji </option>
	        <option value="16"> Kokushibou </option>
	        <option value="17"> Douma </option>
	        <option value="18"> Akaza </option>
	        <option value="19"> Hantengu </option>
	        <option value="20"> Nakime </option>
	        <option value="21"> Gyokko </option>
	        <option value="22"> Daki e Gyuutarou </option>
	        <option value="23"> Kaigaku </option>
	        <option value="24"> Enmu </option>
	        <option value="25"> Hairo </option>
	        <option value="26"> Wakuraba </option>
	        <option value="27"> Mukago </option>
	        <option value="28"> Rui </option>
	        <option value="29"> Kyogai </option>
	        <option value="30"> Kamanue </option>
        </select>
        <div id="div_resultado" class="img-personagens">
            <div class="kagaya">
                <img id="kagaya" src="../assets/img/Hashiras/Kagaya_Ubuyashiki.jpg">
            </div>

            <div class="gyomei">
                <img  id="gyomei" src="../assets/img/Hashiras/GyomeiHimejima_Hashira_Rocha.jpg" alt="">
            </div>

            <div class="sanemi">
                <img  id="sanemi" src="../assets/img/Hashiras/SanemiShinazugawa_Hashira_Vento.jpg" alt="">
            </div>

            <div class="muichiro">
                <img  id="muichiro" src="../assets/img/Hashiras/MuichiroTokito_Hashira_Névoa.jpg" alt="">
            </div>

            <div class="giyu">
                <img  id="giyu" src="../assets/img/Hashiras/GiyuTomioka_Hashira_Agua.png" alt="">
            </div>

            <div class="obanai">
                <img  id="obanai" src="../assets/img/Hashiras/ObanaiIguro_Hashira_Serpentes.jpg" alt="">
            </div>

            <div class="mitsuri">
                <img  id="mitsuri" src="../assets/img/Hashiras/MitsuriKanroji_Hashira_Amor.jpg" alt="">
            </div>

            <div class="tengen">
                <img  id="tengen" src="../assets/img/Hashiras/TengenUzui_Hashira_Som.jfif" alt="">
            </div>

            <div class="kyojuro">
                <img  id="kyojuro" src="../assets/img/Hashiras/KyojuroRengoku_Hashira_Chamas.jpg" alt="">
            </div>

            <div class="shinobu">
                <img  id="shinobu" src="../assets/img/Hashiras/ShinobuKocho_Hashira_Inseto.jfif" alt="">
            </div>

            <div class="tanjiro">
                <img  id="tanjiro" src="../assets/img/tanjiroKamado.jpg" alt="">
            </div>

            <div class="nezuko">
                <img  id="nezuko" src="../assets/img/nezuko.jpeg" alt="">
            </div>

            <div class="inosuke">
                <img  id="inosuke" src="../assets/img/inosuke.png" alt="">
            </div>

            <div class="zenitsu">
                <img  id="zenitsu" src="../assets/img/zenitsu.jpg" alt="">
            </div>

            <div class="muzan">
                <img  id="muzan" src="../assets/img/Onis/Muzan_Kibutsuji.jpg" alt="">
            </div>

            <div class="kokushibou">
                <img  id="kokushibou" src="../assets/img/Onis/Lua_Superior1_Kokushibou.jpg" alt="">
            </div>

            <div class="douma">
                <img  id="douma" src="../assets/img/Onis/Lua_Superior2_Douma.jpg" alt="">
            </div>

            <div class="akaza">
                <img  id="akaza" src="../assets/img/Onis/Lua_Superior3_Akaza.jpg" alt="">
            </div>

            <div class="hantengu">
                <img  id="hantengu" src="../assets/img/Onis/Lua_Superior4_Hantengu.jpg" alt="">
            </div>

            <div class="nakime">
                <img  id="nakime" src="../assets/img/Onis/Lua_Superior4_substituto_Nakime.png" alt="">
            </div>

            <div class="gyokko">
                <img  id="gyokko" src="../assets/img/Onis/Lua_Superior5_Gyokko.jpg" alt="">
            </div>

            <div class="dakiegyuutarou">
                <img  id="dakiegyuutarou" src="../assets/img/Onis/Lua_Superior6_DakieGyuutarou.jpg" alt="">
            </div>

            <div class="kaigaku">
                <img  id="kaigaku" src="../assets/img/Onis/Lua_Superior6_substituto_Kaigaku.jpg" alt="">
            </div>
            
            <div class="enmu">
                <img  id="enmu" src="../assets/img/Onis/Lua_Inferior1_Enmu.jpg" alt="">
            </div>
            
            <div class="hairo">
                <img id="hairo" src="../assets/img/Onis/Lua_Inferior2_Hairo.png" alt="">
            </div>

            <div class="wakuraba">
                <img  id="wakuraba" src="../assets/img/Onis/Lua_Inferior3_Wakuraba.png" alt="">
            </div>

            <div class="mukago">
                <img  id="mukago" src="../assets/img/Onis/Lua_Inferior4_Mukago.png" alt="">
            </div>

            <div class="rui">
                <img  id="rui" src="../assets/img/Onis/Lua_Inferior5_Rui.png" alt="">
            </div>

            <div class="kyogai">
                <img  id="kyogai" src="../assets/img/Onis/Lua_Inferior6_2_Kyogai.jpg" alt="">
            </div>
            
            <div class="kamanue">
                <img  id="kamanue" src="../assets/img/Onis/Lua_Inferior6_substituto_Kamanue.jpg" alt="">
            </div>
        </div>
        <div class="btn-voto">
            <button onclick="votar()">Votar</button>
        </div>
    </div>

    <!-- SUGESTÕES
    <div class="container-sugestao" id="container_sugestao"> 
        <h2> SUGESTÕES </h2>
    </div> -->

</body>
</html>

<script>
    usuario.innerHTML = sessionStorage.NOME_USUARIO;
    var personagemAnterior = 0;
    function personagem(){

        var listaPersonagem = [kagaya, gyomei, sanemi, muichiro, giyu, obanai, mitsuri, tengen, kyojuro, shinobu, tanjiro, nezuko, inosuke, zenitsu, muzan, kokushibou, douma, akaza, hantengu, nakime, gyokko, dakiegyuutarou, kaigaku, enmu, hairo, wakuraba, mukago, rui, kyogai, kamanue]

        
        var personagem = slc_personagem.value;
        
        listaPersonagem[personagemAnterior].style.display = "none";  
        for(var contador = 0; contador <= listaPersonagem.length; contador ++){
            if(contador == personagem){
                listaPersonagem[contador-1].style.display = "block";
                personagemAnterior = contador-1;
            }
        }
    }

        /*if(personagem == 1){
            kagaya.style.display= "block";
            hairo.style.display = "none";
        } else if(personagem == "Hairo"){
            hairo.style.display = "block";
            kagaya.style.display= "none";
        }

        /* if(personagem == 1){
            div_resultado.innerHTML = `
                <div class="kagaya" id="kagaya"><img src="../assets/img/Hashiras/Kagaya_Ubuyashiki.jpg"></div>
            `;
        } */ 
    
        var idUsuarioVar = sessionStorage.ID_USUARIO
    function votar(){
        var fkPersonagemVar = slc_personagem.value;

        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        if (fkPersonagemVar == "select") {
            cardErro.style.display = "flex"
            mensagem_erro.innerHTML = "(Mensagem de erro para todos os campos em branco)";
            
            setInterval(sumirMensagem,2000);
            return false;


            // Enviando o valor da nova input
            fetch(`/votos/votar/${sessionStorage.getItem("FKPERSONAGEM_USARIO")}`, {
                method: "PUT",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js

                    fkPersonagemServer: fkPersonagemVar,
                    idUsuarioServer: idUsuarioVar
                })
                }).then(function (resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    cardErro.style.display = "block";

                    mensagem_erro.innerHTML = "Voto realizado com sucesso! Redirecionando para tela de Rank...";

                    setTimeout(() => {
                        window.location = "../rank.html";
                    }, "2000")

                    limparFormulario();
                    finalizarAguardar();
                } else {
                    throw ("Houve um erro ao tentar realizar o voto!");
                }
        
            }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
            finalizarAguardar();
            });

        return false;

        /* Criar campo onde a partir de um Math.random() encontrar um mestre para caso o usuario selecionar a funcao de 
        exterminador, fazendo com que assim que ele entre no login, mostre o mestre e sua espada na área de Dados */   
        }
    }
    
    function sugestao(){
        container_dados.style.display = "none";
        container_missoes.style.display = "none";
        container_voto.style.display = "none";
        container_sugestao.style.display = "flex";
    }

    
    function sumirMensagem() {
        cardErro.style.display = "none"
    }
</script>